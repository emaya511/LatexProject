\documentclass[main.tex]{subfiles}
\begin{document}
\chapter{Finite Element formulation}

\begin{figure}[h]
\centering
\includestandalone[mode=image,build={quote={}}]{"tikz/FEMdomain"}
%\caption{NAS277} \label{NAS277sch}
\caption{FEM Domain}
\label{fig:fem_domain}
\end{figure}

In finite Element the approximate function is the shape function also called as interpolation function. In here, the continuous domain is discretized into small elements. these elements are either shaped as triangles or quadrangles depending upon the need and choice.   

The description of the domain is given in the the figure : \ref{fig:fem_domain}.  $\Omega$ is the total two dimensional domain in the x , y plane. The domain is discretized into small elements $\Omega^e$. $\Omega_1 \cdots \Omega_n$ are the regions where transverse distributed loads $(q_1 \cdots q_i)$ are described. $\partial \Omega$ is the boundary of the domain. $\partial \Omega _ d$ is part of the boundary where Dirichlet boundary condition is applied. 
\section{Shape-Functions}

The Displacement field of the each element is the function of displacement of degree of freedom of each  node, which lets us have a finite number of unknowns to denote the over all displacement field of the domain. 

Since it is a plate element, three independent degrees of freedom are described for each node. 
\begin{equation*}
\begin{split}
u = \left[ w, \theta_x , \theta_y  \right]^T
\end{split}
\end{equation*}
$w$ represents the transverse displacement. $\theta_x$ and $\theta_y$ represents the rotation. 
\begin{equation}
\theta_x =\frac{\partial w}{\partial x} \qquad
 \theta_y  =\frac{\partial w}{\partial y}
\end{equation}
The approximate displacement of the element is the given as sum of product of nodal degree of freedom and its corresponding shape functions ($N$,$\overline{N}$,$\overline{\overline{N}}$).
\begin{equation}\label{eq:approx_disp}
\begin{split}
\tilde{\mathbf{u}} \approx \sum_{i=1}^{n}\left(N_iw_i+\overline{N}_i\theta_{x_i} +\overline{\overline{N}}_i\theta_{y_i}\right)
\end{split}
\end{equation}



\subsection{Ressigner Midlin Plate Element (Thick/thin plate)}

From the previous chapter, it is understood that the Ressigner midlin plate is specifically developed for thick plate but the plate also performs reasonably well it thin plate situation but at the cost of fine refinement [plate and fem pg:290]. In this element all shear strain is considered, leaving only the out of plane noraml stress $\sigma_zz$ to be neglected. This element only requires $C^0$ continuity of the approximation  which drastically simplifies the implementation of the shape function (\cite{ANA_FEM_Plate_MIT}). The rotations $\theta_x$ and $\theta_y$ are treated as independent variable which in-turn lets us chose independent $C^0$ continuous shape functions for each independent degrees of Freedom.

\begin{equation}\label{eq:approx_disp_Ind}
w =  \sum_{i=1}^{n} N_iw_i
\qquad
\theta_x =  \sum_{i=1}^{n} \overline{N}_i\theta_{x_i}
\qquad
\theta_y =  \sum_{i=1}^{n} \overline{\overline{N}}_i\theta_{y_i}
\end{equation}
 \begin{equation*}
\overline{\overline{N}}_i = \overline{N}_i = N_i
 \end{equation*}
To begin with a simpler case, A simplest of all shape function, a QUAD4 shape function is selected  (\cite{MATLAB_FEM}). Despite it simplicity, the element performs relatively well but it suffers from a 'element lock' when it is too thin (\cite{doi:10.1002/nme.1620210213}).

 
\begin{equation}\label{eq:MITC4_SF}
\begin{split}
N_1  =\frac{1}{4}(1-\xi)(1 -\eta)\quad  
&
 N_2=\frac{1}{4}(1+\xi)(1-\eta) 
 \\
 N_3  =\frac{1}{4}(1+\xi)(1+ \eta)\quad  
 &
  N_4 =\frac{1}{4}(1-\xi)(1+\eta)\end{split}
\end{equation}

The Parent element shape function is given above, which is represents the iso-parametric rectangle element. To describe any arbitrary physical quadrangle element, Jacobian transformation is adapted.
using chain rule.
\begin{equation}
\dfrac{\partial N }{ \partial \xi } = 
\dfrac{\partial N }{ \partial x }
\dfrac{ \partial x }{\partial \xi }  
+
\dfrac{\partial N }{ \partial y }
\dfrac{ \partial y }{\partial \xi } 
\end{equation}
This relation is written in matrix form to get the Jacobin matrix, 
\begin{equation}
\left\{
\begin{array}{r}
\dfrac{\partial N }{ \partial \xi }  \\
\dfrac{\partial N }{ \partial \eta }  \\
\end{array}
\right\}
=
\begin{bmatrix}
\dfrac{ \partial x }{\partial \xi }   &
\dfrac{ \partial y }{\partial \xi } \\
\dfrac{ \partial x }{\partial \eta }   &
\dfrac{ \partial y }{\partial \eta } \\
\end{bmatrix}
\left\{
\begin{array}{r}
\dfrac{\partial N }{ \partial x }  \\
\dfrac{\partial N }{ \partial y }  \\
\end{array}
\right\}
\quad
J=\begin{bmatrix}
\dfrac{ \partial x }{\partial \xi }   &
\dfrac{ \partial y }{\partial \xi } \\
\dfrac{ \partial x }{\partial \eta }   &
\dfrac{ \partial y }{\partial \eta } \\
\end{bmatrix}
\end{equation}
The inverse relation is provided by inverse of the  Jacobin matrix. the graphical representation of the Jacobin representation is given is given in the figure:\ref{fig:JacTrans} .
\begin{equation}
\left\{
\begin{array}{r}
\dfrac{\partial N }{ \partial x }  \\
\dfrac{\partial N }{ \partial y }  \\
\end{array}
\right\}
=
J^{-1}
\left\{
\begin{array}{r}
\dfrac{\partial N }{ \partial \xi }  \\
\dfrac{\partial N }{ \partial \eta }  \\
\end{array}
\right\}
\end{equation}


\begin{figure}[h!]
\centering

\includestandalone[mode=image,build={quote={}}]{"tikz/iso"}
\caption{Jacobian Transformation} 
\label{fig:JacTrans}
\end{figure}

The equation:\ref{eq:approx_disp} is represented in matrix form as 
\begin{equation*}
\tilde{\mathbf{u}}= 
\left\{
\begin{array}{r}
w \\
\theta_x \\
\theta_y \\
\end{array} \right\}
=
\sum_{i=1}^{nN}
\left\{
\begin{array}{r}
N_i w_i \\
\overline{N}_i \theta_{x_i} \\
\overline{\overline{N}}_i \theta_{y_i} \\
\end{array} \right\}
=
\begin{bmatrix}
N_1 & 0 & 0  & \cdots & N_{4} & 0 & 0 \\
0 & \overline{N}_1 & 0  & \cdots & 0 & \overline{N}_{4} & 0 \\
0 & 0 & \overline{\overline{N}}_1 & \cdots & 0 & 0 & \overline{\overline{N}}_{4} \\
\end{bmatrix}
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
\vdots \\
w_{4} \\
\theta_{x_{4}} \\
\theta_{y_{4}} \\
\end{array} \right\}
=
\mathbf{N} \mathbf{\tilde{u}^e} 
\end{equation*}

Now, this FEM matrix from is easier to work with. this will be substituted into the weak form of the equation to get the over ODE in terms of FE matrices. The shape function is independent of time so derivative of $u$ with respect to time will not affect shape function.


\begin{equation}
 \mathbf{ \dot{\tilde{u}} } = \mathbf{N}              \mathbf{\dot{\tilde{u}}^e}
 \qquad  
 \mathbf{ \ddot{\tilde{u}} } = \mathbf{N}  \mathbf{\ddot{\tilde{u}}^e}
\end{equation}
The curvature term in the weak form is given in the equation below eq:\ref{eq:kappa}. it can be notices that the double derivative of the displacement shape function this matrix alone will produce singular stiffness matrix but along with shear strain term (eq: \ref{eq:shear})this will not have zero row or column. 
\begin{equation}\label{eq:kappa}
\mathbf{ \kappa } = 
\begin{bmatrix}
0 & \overline{N}_{1,1} & 0 & \cdots & 0 \\
0&  0 & \overline{\overline{N}}_{1,2}  & \cdots & \overline{\overline{N}}_{4,2} 
\\
0&  \overline{N}_{1,2} & \overline{\overline{N}}_{1,1}  & \cdots & \overline{\overline{N}}_{4,1} 
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
\vdots \\
\theta_{y_{4}} \\
\end{array} \right\}=\mathbf{ B } \mathbf{\tilde{u}^e}
\end{equation}


\begin{equation} \label{eq:shear}
\mathbf{\tilde{\epsilon}^S} = 
\begin{bmatrix}
N_{1,1} & \overline{N}_{1} & 0 & \cdots & 0 
\\
N_{1,2} & 0 & \overline{\overline{N}}_{1} & \cdots & \overline{\overline{N}}_{4} 
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
\vdots \\
\theta_{y_{4}} \\
\end{array} \right\}=\mathbf{ B_S } \mathbf{\tilde{u}^e}
\end{equation}

Terms to corresponding the axial strain is given in eq : \ref{eq:axial}
\begin{equation}\label{eq:axial}
\tilde{w}_{,2} = 
\begin{bmatrix}
{N}_{1,2} & 0 & 0 &{N}_{2,2} & \cdots & 0 \\ 
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
w_{2} \\
\vdots \\
\theta_{y_{nN}} \\
\end{array} \right\}=\mathbf{ H_A }\tilde{\mathbf{u}}^e
\end{equation}
Similarly,
\begin{equation}
\tilde{u}_{i,2} = 
\begin{bmatrix}
{N}_{1,2} & 0 & 0 & \cdots & 0 \\
0 & \overline{N}_{1,2} & 0 & \cdots & 0 \\ 
0 & 0 & \overline{\overline{N}}_{1,2} & \cdots & \overline{\overline{N}}_{4,2} \\ 
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
\vdots \\
\theta_{y_{nN}} \\
\end{array} \right\}=\mathbf{ H_v }\tilde{\mathbf{u}}^e
\end{equation}



The FE Matrix for the body force is given as
\begin{equation}
\tilde{w} = 
\begin{bmatrix}
{N}_{1} & 0 & 0 &{N}_{2} &\cdots & 0 
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
w_2 \\
\vdots \\
\theta_{y_{nN}} \\
\end{array} \right\}=\mathbf{ N_f }\tilde{\mathbf{u}}^e
\end{equation}

[talk about the variation of the terms in ]
\subsection{Kirchhoff plate element ( Thin Plate )}


This plate element is more complicate to implement as the shape function required for it need to be $C^1$ continuous.

For Kirchhoff plates, quite a few elemets which passes patch test exists. \cite{doi:10.1002/nme.1620020210} and \cite{doi:10.1680/iicep.1964.10014} proposed easy method to generate stiffness matrix for rectangular and parallelogram elements. For generating any arbitrary quadrangle element the existing rectangle elements can be used by transformation, but they perform badly[\cite{ZIENKIE_BOOK_STRUCT_CH11}]. To overcome this issue, two or more triangle elements are joined to create a quadrangle elements. Triangle element uses different coordinate system called area coordinate system which has three axis.

\subsubsection{Area Coordinates}


\begin{figure}[h!]
\centering

\includestandalone[mode=image,build={quote={}}]{"tikz/area_cod"}
\caption{Jacobian Transformation} 
\label{fig:JacTrans}
\end{figure}


Area coordinate is a parametric coordinates three coordinates($L_1$,$L_2$,$L_3$), which defined as
\begin{equation}
L_1 = \frac{A_1}{A} \quad L_2 = \frac{A_2}{A} \quad L_3 = \frac{A_3}{A}
\end{equation}
for which , it must satisfy
\begin{equation}
L_1 + L_2 + L_3 = 1 \quad (or) \quad A_1 + A_2 + A_3 = A
\end{equation}
There is a linear relation between this coordinate and Cartesian coordinate which is given as
\begin{equation}
\left\{
\begin{array}{r}
1\\
x \\
y
\end{array} \right\}
=
\begin{bmatrix}
1 & 1 & 1 \\
x_1 & x_2 & x_3 \\
y_1 & y_2 & y_3  
\end{bmatrix} 
\left\{
\begin{array}{r}
L_1\\
L_2 \\
L_3
\end{array} \right\}
\end{equation}
\begin{equation}
\Delta = \begin{vmatrix}
1 & 1 & 1 \\
x_1 & x_2 & x_3 \\
y_1 & y_2 & y_3  
\end{vmatrix} 
\end{equation}
The linear transform between the derivative of coordinates area coordinate and Cartesian coordinate.
\begin{equation}
\left\{
\begin{array}{r}
 \frac{\partial}{\partial x}\\
\frac{\partial}{\partial y}
\end{array} \right\}
=
\frac{1}{2 \Delta}
\begin{bmatrix}
y_2-y_3 & y_3-y_1 & y_1-y_2 \\
x_2-x_3 & x_3-x_1 & x_1-x_2
\end{bmatrix} 
\left\{
\begin{array}{r}
 \frac{\partial}{\partial L_1}\\
 \frac{\partial}{\partial L_2}\\
 \frac{\partial}{\partial L_3}
\end{array} \right\}
\end{equation}
Similarly, the relation for second derivative is given as.
\begin{equation}
\begin{bmatrix}
 \frac{\partial ^ 2}{\partial x ^2}   &  \frac{\partial ^ 2}{\partial x \partial y }   
 \\
\frac{\partial ^ 2}{\partial x \partial y } &  \frac{\partial ^ 2}{\partial y ^2} 
\end{bmatrix} 
=
\frac{1}{4 \Delta ^2}
\begin{bmatrix}
y_2-y_3 & y_3-y_1 & y_1-y_2 \\
x_2-x_3 & x_3-x_1 & x_1-x_2
\end{bmatrix} 
\begin{bmatrix}
 \frac{\partial^2}{\partial L_1 ^2} &  \frac{\partial^2}{\partial L_1 \partial L_2} &  \frac{\partial^2}{\partial L_1 \partial L_3}  \\
 \frac{\partial^2}{\partial L_1 \partial L_2} & \frac{\partial^2}{\partial L_2 ^2} &   \frac{\partial^2}{\partial L_2 \partial L_3}  \\
 \frac{\partial^2}{\partial L_1 \partial L_3} &   \frac{\partial^2}{\partial L_3 \partial L_2} & \frac{\partial^2}{\partial L_3 ^2}   
\end{bmatrix} 
\begin{bmatrix}
y_2-y_3 & x_2-x_3  \\
y_3-y_1 &  x_3-x_1  \\
y_1-y_2 &  x_1-x_2
\end{bmatrix} 
\end{equation}




\subsubsection{PAT element Shape function}
The triangle element with three nodes, is given here. This element passes patch test and it is referred from \cite{ZIENKIE_BOOK_STRUCT_CH11}. In literature this element is referd as PAT. The element was developed by \cite{specht}. The element is based in a polynomial expression of nine terms.
 

\begin{equation}\label{eq:poly}
\begin{split}
\textbf{P} & = [
\begin{matrix}
L_1
&
L_2
&
L_3
&
L_1 L_2
&
L_2 L_3
&
L_3 L_1
\end{matrix} \\
& \quad
\begin{matrix}
L_1^2L_2+\frac{1}{2}L_1L_2L_3(3(1-\mu_3)L_1-(1+3\mu_3)L_2+(1+3\mu_3)L_3) )
\end{matrix}\\
& \quad
\begin{matrix}
L_2^2L_3+\frac{1}{2}L_1L_2L_3(3(1-\mu_1)L_2-(1+3\mu_1)L_3+(1+3\mu_1)L_1) )
\end{matrix}\\
& \quad
\begin{matrix}
L_3^2L_1+\frac{1}{2}L_1L_2L_3(3(1-\mu_2)L_3-(1+3\mu_2)L_1+(1+3\mu_2)L_2) )
\end{matrix} ]
\end{split}
\end{equation}

\begin{equation}
\mu_1 = \frac{l_3^2-l_2^2}{l_1^2} \quad
\mu_2 = \frac{l_1^2-l_3^2}{l_2^2} \quad
\mu_3 = \frac{l_2^2-l_1^2}{l_3^2}
\end{equation}

$l_a$ is the length of the side which is opposite to the side a. The nine shape functions for this element using the polynomial expression \ref{eq:poly}.

\begin{equation}
N = 
\begin{bmatrix}
                 P(1)-P(4)+P(6)+2*(P(7)-P(9))\\
                 -b(2)*(P(9)-P(6))-b(3)*P(7)\\
                 -c(2)*(P(9)-P(6))-c(3)*P(7)\\
                 P(2)-P(5)+P(4)+2*(P(8)-P(7))\\
                 -b(3)*(P(7)-P(4))-b(1)*P(8)\\
                 -c(3)*(P(7)-P(4))-c(1)*P(8)\\
                 P(3)-P(6)+P(5)+2*(P(9)-P(8))\\
                -b(1)*(P(8)-P(5))-b(2)*P(9)\\
                -c(1)*(P(8)-P(5))-c(2)*P(9)\\
\end{bmatrix}
\end{equation}

The terms in the weak form is expressed in terms of Shape function and given below

%\begin{equation}
% \mathbf{ \dot{\tilde{u}} } = \mathbf{N}              %\mathbf{\dot{\tilde{u}}^e}
% \qquad  
% \mathbf{ \ddot{\tilde{u}} } = \mathbf{N}  %\mathbf{\ddot{\tilde{u}}^e}
%\end{equation}




\begin{equation*}
\tilde{\mathbf{u}}= 
\left\{
\begin{array}{r}
w \\
\theta_x \\
\theta_y \\
\end{array} \right\}
=
\begin{bmatrix}
{N}_{1} & N_{2} & N_{3} &{N}_{4} &\cdots & N_{9} \\
{N}_{1,1} & N_{2,1} & N_{3,1} &{N}_{4,1} &\cdots & N_{9,1} \\
{N}_{1,2} & N_{2,2} & N_{3,2} &{N}_{4,2} &\cdots & N_{9,2} 
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
w_2 \\
\vdots \\
\theta_{y_{3}} \\
\end{array} \right\}
=
\mathbf{N} \mathbf{\tilde{u}^e} 
\end{equation*}




the other terms is the weak form are also given given below. The strain caused by the axial loading is given below.



\begin{equation}\label{eq:kappa_KR}
\mathbf{ \kappa } = 
\begin{bmatrix}
N_{1,11} & N_{2,11} & N_{3,11} & \cdots & N_{9,11} \\
N_{1,22} & N_{2,22} & N_{3,22} & \cdots & N_{9,22} \\
N_{1,12} & N_{2,12} & N_{3,12} & \cdots & N_{9,12} 
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
\vdots \\
\theta_{y_{3}} \\
\end{array} \right\}=\mathbf{ B } \mathbf{\tilde{u}^e}
\end{equation}

\begin{equation}\label{eq:axial_KR}
\tilde{w}_{,2} = 
\begin{bmatrix}
N_{1,2}  & N_{2,2}  & N_{3,2} & N_{4,2}  & \cdots & N_{9,2} \\
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
w_{2} \\
\vdots \\
\theta_{y_{3}} \\
\end{array} \right\}=\mathbf{ H_A }\tilde{\mathbf{u}}^e
\end{equation}

\begin{equation}
\tilde{u}_{i,2} = 
\begin{bmatrix}
N_{1,2}  & N_{2,2}  & N_{3,2}  & \cdots & N_{9,2} \\
N_{1,22} & N_{2,22} & N_{3,22} & \cdots & N_{9,22} \\
N_{1,12} & N_{2,12} & N_{3,12} & \cdots & N_{9,12} 
\end{bmatrix}
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
\vdots \\
\theta_{y_{3}} \\
\end{array} \right\}=\mathbf{ H_v }\tilde{\mathbf{u}}^e
\end{equation}



The FE Matrix for the body force is given as
\begin{equation}
\tilde{w} = 
\begin{bmatrix}
{N}_{1} & N_{2} & N_{3} &{N}_{4} &\cdots & N_{9} 
\end{bmatrix} 
\left\{
\begin{array}{r}
w_1 \\
\theta_{x_1} \\
\theta_{y_1} \\
w_2 \\
\vdots \\
\theta_{y_{3}} \\
\end{array} \right\}=\mathbf{ N_f }\tilde{\mathbf{u}}^e
\end{equation}


\subsection{Final FE form}
Weak Form to FE format
The Finite Element Matrix equation is given as

\begin{equation*}
\begin{split} 
\int \int_\Omega 
\left(
\rho
\left[ \mathbf{N}  \right]
\left[ \mathbf{Z}  \right]
\left[ \mathbf{N}  \right] 
\{ \ddot{\tilde{\mathbf{u}}}^e \}
\right) 
\delta \tilde{\mathbf{u}}^e
+
\left( 
2 \rho V_1
\left[ \mathbf{N}  \right]
\left[ \mathbf{Z}  \right]
\left[ \mathbf{H_v}  \right] 
\{ \dot{\tilde{\mathbf{u}}}^e \}
\right) 
\delta \tilde{\mathbf{u}}^e \\
-
\left( 
 \rho V_1^2
\left[ \mathbf{H_v}  \right]
\left[ \mathbf{Z}  \right]
\left[ \mathbf{H_v}  \right] 
\{\tilde{\mathbf{u}}^e \}
\right) 
\delta \tilde{\mathbf{u}}^e  
+
\left( 
\left[ \mathbf{B}  \right]
\left[ \mathbf{\tilde{D}}  \right]
\left[ \mathbf{B}  \right] 
\{\tilde{\mathbf{u}}^e \}
\right) 
\delta \tilde{\mathbf{u}}^e  \\
+
\left( 
\left[ \mathbf{B_S}  \right]
\left[ \mathbf{\tilde{D}_S}  \right]
\left[ \mathbf{B_S}  \right] 
\{\tilde{\mathbf{u}}^e \}
\right) 
\delta \tilde{\mathbf{u}}^e
+
\left( 
\left[ \mathbf{H_A}  \right]
\left[ \mathbf{\tilde{N}_A}  \right]
\left[ \mathbf{H_A}  \right] 
\{\tilde{\mathbf{u}}^e \}
\right) 
\delta \tilde{\mathbf{u}}^e
d \Omega
   \\
 =   
 \sum_i^{nb}   \int  \int_{\Omega_i} 
\left(  
 q_i 
\left[ \mathbf{\tilde{N}_f}  \right] 
\right)  
\delta \tilde{\mathbf{u}}^e
  d \Omega_i  
\end{split} 
\end{equation*}

After rearranging them to their respective groups we get.
\begin{equation*}
\left[ \mathbf{M^e}  \right] 
\{ \ddot{\mathbf{u}} \}
+
\left[ \mathbf{C^e}  \right] 
\{ \dot{\mathbf{u}} \}
+
\left[ \mathbf{K^e}  \right] 
\{\mathbf{u} \}
=
\{ \mathbf{F^e} \}
\end{equation*}
where 
\begin{align*}
&\left[ \mathbf{M^e}  \right]  
= \rho
\int \int_\Omega 
\left(
\left[ \mathbf{N}  \right]
\left[ \mathbf{Z}  \right]
\left[ \mathbf{N}  \right] 
\right)  d \Omega  \\
&\left[ \mathbf{C^e}  \right]   
= 2 \rho V_1
\int \int_\Omega 
\left( 
\left[ \mathbf{N}  \right]
\left[ \mathbf{Z}  \right]
\left[ \mathbf{H_v}  \right] 
\right)  d \Omega  \\ &
\left[ \mathbf{K^e}  \right] 
=  - \rho V_1^2
\int \int_\Omega 
\left( 
\left[ \mathbf{H_v}  \right]
\left[ \mathbf{Z}  \right]
\left[ \mathbf{H_v}  \right] 
\right)  d \Omega + 
\int \int_\Omega  
\left[ \mathbf{B}  \right]
\left[ \mathbf{\tilde{D}}  \right]
\left[ \mathbf{B}  \right]  
  d \Omega   \\  &  \quad +
  \int \int_\Omega  
\left[ \mathbf{B_S}  \right]
\left[ \mathbf{\tilde{D}_S}  \right]
\left[ \mathbf{B_S}  \right] 
  d \Omega +
  \int \int_\Omega  
\left[ \mathbf{H_A}  \right]
\left[ \mathbf{\tilde{N}_A}  \right]
\left[ \mathbf{H_A}  \right]  
  d \Omega  \\ &
\{ \mathbf{F^e} \}  = 
 \sum_i^{nb}   \int  \int_{\Omega_i}   
 q_i 
\left[ \mathbf{\tilde{N}_f}  \right] 
  d \Omega_i    
\end{align*}





\subsection{Numerical Integration}
For the numerical integration of the Finite element matrix, Gauss quadrature is used here. The integration for a element is provided by sum of product of Gauss weight and value of the term at the Gauss point \ref{eq:gauss}. 


\begin{equation} \label{eq:gauss}
\begin{split}
\int \int f(x,y) dx dy = 
 \sum_{i = 1}^{n_g}  w_i  \cdot f(ix_g,iy_g) 
\end{split}
\end{equation}

$n_g$ is the number of Gauss points. $w_i$ Gauss weight and $(ix_g,iy_g)$ is the Gauss coordinate. Gauss weights and points for each element is given in the table : \ref{tb:gauss}. Using Gauss quadrature information, new relation for element mass matrix is given in \ref{eq:gauss_Me}

\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
Element                & $n_g$ & Gauss Point $(ix_g,iy_g)$                                   & Gauss weight $(w_i)$   \\ \hline
PAT                    & 3     & \{(1/2,1/2,0) (1/2,0,1/2) (0,1/2,1/2)\}       & \{1/3,1/3,1/3\} \\ \hline
\multirow{2}{*}{QUAD4} & 4     & \{(0.5,0.5) (0.5,-0.5)(-0.5,0.5)(-0.5,-0.5)\} & \{1,1,1,1\}     \\ \cline{2-4} 
                       & 1     & \{(0,0)\}                                     & \{4\}           \\ \hline
\end{tabular}
\caption{Gauss points and weights}
\label{tb:gauss}
\end{table}

\begin{equation}\label{eq:gauss_Me}
\left[ \mathbf{M^e}  \right] 
=
\sum_{i = 1}^{ng}
\rho\left(w_i
\left[ \mathbf{N(i)}  \right]^T
\left[ \mathbf{Z}  \right]
\left[ \mathbf{N(i)}  \right] 
det(J)\right)  d \Omega
\end{equation}
All the Element mass Matrices $\left[ \mathbf{M^e}  \right]$ are assembled in the final Mass Matrix $\left[ \mathbf{M} \right]$, similarly for other element matrices gives us the final FE ODE.



\begin{equation}
\left[ \mathbf{M}  \right] 
\{ \ddot{\mathbf{u}} \}
+
\left[ \mathbf{C}  \right] 
\{ \dot{\mathbf{u}} \}
+
\left[ \mathbf{K}  \right] 
\{\mathbf{u} \}
=
\{ \mathbf{F} \}
\end{equation}



\section{Solution Methods}
Since Matlab is used to program, all the necessary functions are already available with in matlab. To solve the static problems u=A/b function is used as it factorizes the matrix and solves them, which is much efficient than direct inversion of the A matrix. the find the natural frequency eigs function is used, which find the subspace of the eigen function. this function is very useful since we only ever need few eigen frequencies that the small. To solve the dynamic problem, New mark Time integration is used. The reason is that, this technique is unconditionally  stable and ability to provide numerical damping.



%\subsection{New-mark Time integration Technique}

 



%begin{equation*}
%R=F_t + \mathbf{M} \left(a_0 u_{t}+a_2 v_{t} + a_3 a_{t} \right) + \mathbf{C} \left(a_1 u_{t}+a_4 v_{t} + a_5 a_{t} \right) 
%\end{equation*}
%\begin{equation*}
%u_{t+1}=\left[a_0 \mathbf{M} + a_1 \mathbf{C} + \mathbf{K} \right] ^ {-1} R
%\end{equation*}
%\begin{equation*}
%v_{t+1}=a_1 \left( u_{t+1} - u_{t} \right) - a_4 %v_t -a_5 a_t
%\end{equation*}
%\begin{equation*}
%a_{t+1}=a_0 \left( u_{t+1} - u_{t}\right) - a_2 %v_t -a_3 a_t
%\end{equation*}

%\begin{align*}
%&a_0 = \frac{1}{\alpha h^2}& 
%&a_1 = \frac{\theta}{\alpha h} & 
%&a_2 = \frac{1}{\alpha h} \\
%&a_3 = \frac{1}{2 \alpha }-1 &  
%&a_4 = \frac{\theta}{\alpha} & 
%& a_5 = \frac{h}{2} \frac{\theta}{\alpha}-2
%\end{align*}


%Unconditionally Stable for
%\begin{align*}
%\theta & \geq \frac{1}{2}  \\
%\alpha & \geq \frac{1}{4}\left(\frac{1}{2}+\theta %\right)^2
%\end{align*}





\section{Integration with Control Algorithm}
The main objective of the thesis is to code FEM that will be used as simulator for control algorithms. To do two methods are used. 

\subsection{State - Space Format}

State - Space form is the widely used format for control study of a systemic system. state - state form is represented as first order ordinary differential equation eq:\ref{eq:SpaceState}. The dynamic system that is present here is a second order differential equation eq:{refer eq}. This Second order equation is converted to first order equation for which it will consistent to the  state space form. The another reason is that it is easier to represent input and output of the system in a MATLAB Simulink block.  

\begin{equation}\label{eq:SpaceState}
\dot{x}(t)=Ax(t)+B
\end{equation}
\textbf{B or Bu??}
$x(t)$ is the state variable.

\begin{equation}
{x} = 
\left\{
\begin{array}{r}
u(t)
\\
\dot{u}(t)
\end{array}
\right\}
\end{equation}
using this the second order ODE is reprented in state - space form as

\begin{equation}
\dot{x} = \frac{d}{dt}
\left\{
 \begin{array}{r}  u(t)  \\  \dot{u}(t) \end{array}
\right\}
=
\begin{bmatrix}
0 & I \\
-\left[M\right] ^{-1} \left[K\right]  &   -\left[M\right] ^{-1} \left[C\right]
\end{bmatrix}
\left\{
\begin{array}{r}
u(t)
\\
\dot{u}(t)
\end{array}
\right\}
+
\begin{bmatrix}
0 \\
\left[M\right] ^{-1} \left[F\right] 
\end{bmatrix}
\end{equation}

Unfortunately, the FEM discretization of the domain have huge number of nodes which means the system size will also be huge.Which creates its own problems. when an attempt to made to solve the full FEM model of the system it the simulink block would not converge. To over come this problem a the size of the model is reduced by using modal - superposition method. After using Modal - Superposition technique, drastic improvements in the solution time is observed but the loss of accuracy is not studied during the thesis.  

\begin{comment}

[\textbf{insert simulink strucutr}]

%\subsubsection{Modal Superposition method}


%bla bla bla

\begin{equation}
u = \overline{u} e^{i \omega t}
\end{equation}

$\overline{u}$ is the natural mode. $\omega$ is the natural mode of the system.

using orthoganlity [\textbf{bla bla bla}], the system is reduced into as

\begin{equation}
 \left[  \overline{ K } \right]  =   \left\{ \overline{u}  \right\} ^ T
 \left[K\right] 
  \left\{ \overline{u}  \right\} 
\end{equation}

\begin{equation}
 \left[  \overline{ C } \right]  =   \left\{ \overline{u}  \right\} ^ T
 \left[C\right] 
  \left\{ \overline{u}  \right\} 
\end{equation}

\begin{equation}
 \left[  \overline{ M } \right]  =   \left\{ \overline{u}  \right\} ^ T
 \left[M\right] 
  \left\{ \overline{u}  \right\} 
\end{equation}

[write full reduced ODE]

By doing this, the efficiency of the system increases drastically. 

\end{comment}
\subsection{Object oriented Programming}

In the Industry, to effectively and rapidly control the metal Strip, a sensor is placed which measures the vibration of the plate. Then the data is used to calculate the signal to be given to the electromagnets. The formula can be simple to complex. But the underlying concept is that force vector $F(t+1)$ which is to be applied is the function of displacement vectors $U(t) \cdots U(1)$ of previous time steps.




where $K_1$ and $K_N$ are control parameters which are adjusted to change the properties of the control law. effectively testing such control laws is also very essential before implementing in the plant. To implement this, altering the code source file each time is not feasible may prone to error. So to provide a easy interface, Object oriented Programming is adapted. Forces, Displacements, Time series, Solver Time, Probes are the Matlab class. Number of Operator overloading functions are defined to operate between the objects of these classes. 




\end{document}